@{
    Layout = null;
}
<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <title>Login - KopiKodir</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">

    <!-- Bootstrap Icons -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.5/font/bootstrap-icons.css" rel="stylesheet">

    <style>
        body {
            background: linear-gradient(135deg, #6f42c1, #b197fc);
            min-height: 100vh;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        .login-card {
            max-width: 420px;
            width: 100%;
            background-color: white;
            padding: 2rem;
            border-radius: 0.75rem;
            box-shadow: 0 0 20px rgba(0,0,0,0.1);
        }
        .brand-icon {
            width: 50px;
            height: 50px;
        }
    </style>
</head>
<body>

    <div id="loader" class="d-none position-fixed top-0 start-0 w-100 h-100 bg-white bg-opacity-75 d-flex justify-content-center align-items-center" style="z-index: 1050;">
        <div class="spinner-border text-primary" role="status">
            <span class="visually-hidden">Loading...</span>
        </div>
    </div>

    <div class="login-card text-center">
        <!-- Logo -->
        <svg xmlns="http://www.w3.org/2000/svg" class="brand-icon mb-2" fill="#6f42c1" viewBox="0 0 24 24">
            <path d="M18 8h1a3 3 0 0 1 0 6h-1v1a3 3 0 0 1-3 3H6a3 3 0 0 1-3-3V8h15zm1 4a1 1 0 0 0 0-2h-1v2h1zm-3 3V10H5v5a1 1 0 0 0 1 1h10a1 1 0 0 0 1-1zM8 2h2v3H8V2zm4 0h2v3h-2V2zM4 2h2v3H4V2z"/>
        </svg>
        <h4 class="fw-bold mb-3">Masuk ke KopiKodir</h4>

        <!-- Login Form -->
        <form method="post" id="formLogin">
            @Html.AntiForgeryToken()

            <div class="mb-3 text-start">
                <label for="email" class="form-label">Email</label>
                <input type="email" class="form-control" name="Email" id="email" required>
            </div>

            <div class="mb-3 text-start">
                <label for="password" class="form-label">Password</label>
                <div class="input-group">
                    <input type="password" class="form-control" name="Password" id="password" required>
                    <button type="button" class="btn btn-outline-secondary" onclick="togglePassword(this, 'password')">
                        <i class="bi bi-eye-slash"></i>
                    </button>
                </div>
            </div>

            <div class="d-grid">
                <button type="submit" class="btn btn-primary">Login</button>
            </div>

            <p class="mt-3 small">Belum punya akun? <a href="@Url.Action("Daftar", "Auth")">Daftar sekarang</a></p>
        </form>
    </div>

    <!-- Bootstrap JS & jQuery -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>

    <script>
        $(document).on("submit", "#formLogin", function(e) {
            e.preventDefault();

            let dataForm = $("#formLogin").serialize();

            $("#loader").removeClass("d-none");

            $.ajax({
                url: "/Auth/ActionLogin",
                type: 'POST',
                data: dataForm,
                success: function(response) {
                    console.log(response);

                    if(response.role == "deliver") {
                        window.location.href = "@Url.Action("Index", "Deliver")";
                    } else {
                        window.location.href = "@Url.Action("Index", "CustomerPage")";
                    }
                },
                error: function(xhr, status, code) {
                    const json = JSON.parse(xhr.responseText); 
                    alert(json.pesan);
                },
                complete: function() {
                    $("#loader").addClass("d-none");
                }
            });
        });
    </script>

    <!-- Toggle Password Visibility -->
    <script>
        function togglePassword(button, inputId) {
            const input = document.getElementById(inputId);
            const icon = button.querySelector('i');

            if (input.type === "password") {
                input.type = "text";
                icon.classList.remove("bi-eye-slash");
                icon.classList.add("bi-eye");
            } else {
                input.type = "password";
                icon.classList.remove("bi-eye");
                icon.classList.add("bi-eye-slash");
            }
        }
    </script>

</body>
</html>
